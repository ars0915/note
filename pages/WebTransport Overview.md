# Background
	- **傳統雙向數據流方案**  WebSockets 的順序性導致的 Head-of-Line Blocking 問題影響低延遲應用的效能
		- **Head-of-Line Blocking（HOL Blocking）** 是指當數據流中的一個數據包（或訊息）因為某些原因（例如丟失、延遲或必須按順序處理）而被阻塞時，後續的數據包也無法繼續傳輸或處理，即使它們之間沒有直接的依賴關係。
			- **HTTP/2**：雖然它透過多路復用（multiplexing）允許多個流在同一個 TCP 連線上並行傳輸，但如果底層 TCP 連線發生 HOL Blocking，所有流仍然會被影響。
			- **HTTP/3**：基於 QUIC（UDP 之上的協議），解決了 TCP 的 HOL Blocking 問題，允許獨立的流在不同的 QUIC 連接內並行傳輸，即使某個流遇到問題，也不會影響其他流。
	- **現有替代方案**
		- WebRTC 依賴 ICE 和 userspace SCTP，導致採用率低
			- SCTP 通訊協定之多重串流特性有別於傳統的 TCP 通訊協定單一串流（single-stream），當端點建立連線時，可預先相互協調將要使用的串流數量，並且能夠將不同類型的資料分別以不同的串流傳輸
		- 多 WebSocket 連線的替代設計: 透過 HTTP/3 開啟多個 WebSocket 連線
			- 主要缺點：
				- 每個流都需要 WebSocket 握手，增加 RTT
				- 只能由客戶端啟動流，缺乏伺服器啟動的能力
				- WebSocket 連線通常會被「使用者代理（user agent）」集中管理，當應用程式開啟多個 WebSocket 連線時，**瀏覽器可能會嘗試將它們集中管理（pooled）**，讓它們在同一個 TCP 連線上共享資源。
				  但這不是標準化的行為，每個瀏覽器的實作方式可能不同。
				  **開發者無法確保所有 WebSocket 連線都會被集中在同一個 TCP 連線上。**
				  如果 WebSockets 被分配到不同的 TCP 連線，那麼這些連線之間可能會互相影響（如網路擁塞時），而這種影響是不可預測的。
	- **WebTransport 的優勢**
		- WebTransport 提供 **單一連線、多流（multiplexed streams）** 的設計，確保所有流在同一個連線內。
		- 開發者可以確保所有數據流共享同一個 QUIC 連線，避免 WebSocket 這種不可預測的行為。
		- **能夠優化不同數據流的傳輸優先級**，例如某些流可以設定為高優先級，某些流則可以允許丟包（類似 UDP）。
		- 提供不可靠數據報傳輸 (類似 UDP)
- # Definition
	- WebTransport 是一個框架，旨在為應用開發者提供一個抽象化的傳輸層，同時保留部分關鍵的傳輸層特性。它基於以下概念：
	- **1. WebTransport Session**
		- 單一的通訊上下文（context），用於客戶端與伺服器之間的傳輸。
		- 可能對應到獨立的傳輸層連線，也可能是**共享**的多路復用（multiplexed）連線的一部分。
		- 即使多個會話共享相同的底層連線，它們在邏輯上仍然是獨立的。
	- **2. WebTransport Protocol**
		- 一種特定的協議，用來建立 WebTransport 會話。
	- **3. Datagram**
		- **不可靠傳輸**的數據單元（類似 UDP）。
		- 受 **最大傳輸單元（MTU）** 限制。
		- 傳輸時不保證可靠性或順序。
	- **4. Stream**
		- **可靠傳輸**（類似 TCP）。
		- 以位元組序列的形式傳輸，確保接收端的順序與發送端相同。
		- 可以是任意長度，無法全部緩存，因此 API 允許**部分數據讀取**。
	- **5. Message**
		- 一種特殊類型的 Stream，足夠小以至於可以**完全緩存**後再傳遞給應用。
		- WebTransport **不直接定義**訊息，而是透過完全緩存 Stream 來模擬訊息的行為。
		- WebSockets 使用訊息作為核心抽象，而 WebTransport 則沒有這種限制。
	- **6. Server**
		- **接受 WebTransport 會話**的應用程式。
		- 若 WebTransport 建立於 **多路復用協議（如 HTTP/2 或 HTTP/3）** 之上，則「WebTransport 伺服器」指的是特定端點（如特定 HTTP 資源的處理程序），而非 TCP/UDP 層級的網路監聽應用。
	- **7. Client**
		- **發起 WebTransport 會話**的應用程式。
		- 可能運行在受限的安全環境中，例如瀏覽器中的 JavaScript 應用。
	- **8. User Agent**
		- **代表客戶端創建 WebTransport 連線的軟體系統**。
		- 具有完全的網路存取權限，例如瀏覽器或其他能夠管理 WebTransport 會話的軟體。
- # Requirements
	- WebTransport 的協議設計需要滿足多項安全性與運作要求：
	- 所有傳輸必須加密（TLS 1.3 或 DTLS）。
	- Server 必須明確允許 Client 發送數據。
	- Client 必須受到流量限制，避免頻寬濫用。
	- 必須支援多個 WebTransport session 的並行運作。
	- 限制 Client 只能連線到授權的 WebTransport Server。
	- Server 必須能識別請求的來源（Origin）。
	- Server endpoint 必須能夠以 URI 表示，方便與 Web 平台整合。
-
-
- # Reference
- [https://datatracker.ietf.org/doc/draft-ietf-webtrans-overview/](https://datatracker.ietf.org/doc/draft-ietf-webtrans-overview/)
- [https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3/#name-quic-webtransport-and-http-](https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-http3/#name-quic-webtransport-and-http-)
- https://sites.google.com/site/applezulab/network/sctp_introduction
-